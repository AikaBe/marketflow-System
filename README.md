MarketFlow
MarketFlow ‚Äî —ç—Ç–æ —Å–∏—Å—Ç–µ–º–∞ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ä—ã–Ω–æ—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º hexagonal architecture, –Ω–∞–ø–∏—Å–∞–Ω–Ω–∞—è –Ω–∞ Go. –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø–æ–ª—É—á–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ —Å —Å–∏–º—É–ª—è—Ç–æ—Ä–æ–≤ –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç–Ω—ã—Ö –±–∏—Ä–∂ –∏–ª–∏ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ, –∞–≥—Ä–µ–≥–∏—Ä—É–µ—Ç —Ü–µ–Ω—ã, —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –∏—Ö –≤ PostgreSQL –∏ –∫—ç—à–∏—Ä—É–µ—Ç –≤ Redis. –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π REST API –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —É–¥–æ–±–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏.

üìê –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
–ü—Ä–æ–µ–∫—Ç —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –ø–æ –ø—Ä–∏–Ω—Ü–∏–ø–∞–º Hexagonal Architecture (Ports & Adapters) –∏ —Ä–∞–∑–¥–µ–ª—ë–Ω –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–µ —Å–ª–æ–∏:

Domain Layer ‚Äî –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ –∏ –º–æ–¥–µ–ª–∏.

Application Layer ‚Äî –æ–±—Ä–∞–±–æ—Ç–∫–∞ use-case'–æ–≤, —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ—Ç–æ–∫–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö.

Adapters:

HTTP Adapter ‚Äî REST API (/handler)

Storage Adapter ‚Äî PostgreSQL (/repository)

Cache Adapter ‚Äî Redis (/cache)

Exchange Adapter ‚Äî –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Ä–µ–∞–ª—å–Ω—ã–º –∏–ª–∏ —Ç–µ—Å—Ç–æ–≤—ã–º –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º.

üèóÔ∏è –°–±–æ—Ä–∫–∞
bash
Copy
Edit
docker-compose run --rm load_images
docker-compose build
‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
–§–∞–π–ª –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ (config.yaml) —Å–æ–¥–µ—Ä–∂–∏—Ç —Å–ª–µ–¥—É—é—â–∏–µ –ø–æ–ª—è:

yaml
Copy
Edit
postgres:
  host: localhost
  port: 5432
  user: marketflow
  password: secret
  dbname: marketflow_db

redis:
  host: localhost
  port: 6379
  password: ""

exchanges:
  - name: exchange1
    host: 127.0.0.1
    port: 40101
  - name: exchange2
    host: 127.0.0.1
    port: 40102
  - name: exchange3
    host: 127.0.0.1
    port: 40103
üöÄ –ó–∞–ø—É—Å–∫
bash
Copy
Edit
docker-compose up
–î–ª—è live-—Ä–µ–∂–∏–º–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–µ –æ–±—Ä–∞–∑—ã:

bash
Copy
Edit
docker load -i exchange1_amd64.tar
docker run -p 40101:40101 -d exchange1_amd64

docker load -i exchange2_amd64.tar
docker run -p 40102:40102 -d exchange2_amd64

docker load -i exchange3_amd64.tar
docker run -p 40103:40103 -d exchange3_amd64
–î–ª—è —Ç–µ—Å—Ç–æ–≤–æ–≥–æ —Ä–µ–∂–∏–º–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä.

üîÅ –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ç–æ—Ä–≥–æ–≤—ã–µ –ø–∞—Ä—ã
BTCUSDT

DOGEUSDT

TONUSDT

SOLUSDT

ETHUSDT

üîå API
üìä Market Data API
–ú–µ—Ç–æ–¥	Endpoint	–û–ø–∏—Å–∞–Ω–∏–µ
GET	/prices/latest/{symbol}	–ü–æ—Å–ª–µ–¥–Ω—è—è —Ü–µ–Ω–∞ –ø–æ —Å–∏–º–≤–æ–ª—É
GET	/prices/latest/{exchange}/{symbol}	–ü–æ—Å–ª–µ–¥–Ω—è—è —Ü–µ–Ω–∞ –ø–æ –±–∏—Ä–∂–µ
GET	/prices/highest/{symbol}	–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞
GET	/prices/highest/{exchange}/{symbol}	–ú–∞–∫—Å. —Ü–µ–Ω–∞ –ø–æ –±–∏—Ä–∂–µ
GET	/prices/highest/{symbol}?period=1m	–ú–∞–∫—Å. —Ü–µ–Ω–∞ –∑–∞ –ø–µ—Ä–∏–æ–¥
GET	/prices/lowest/{symbol}	–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞
GET	/prices/lowest/{exchange}/{symbol}	–ú–∏–Ω. —Ü–µ–Ω–∞ –ø–æ –±–∏—Ä–∂–µ
GET	/prices/lowest/{symbol}?period=1m	–ú–∏–Ω. —Ü–µ–Ω–∞ –∑–∞ –ø–µ—Ä–∏–æ–¥
GET	/prices/average/{symbol}	–°—Ä–µ–¥–Ω—è—è —Ü–µ–Ω–∞
GET	/prices/average/{exchange}/{symbol}	–°—Ä–µ–¥–Ω—è—è —Ü–µ–Ω–∞ –ø–æ –±–∏—Ä–∂–µ
GET	/prices/average/{exchange}/{symbol}?period=1m	–°—Ä–µ–¥–Ω—è—è —Ü–µ–Ω–∞ –∑–∞ –ø–µ—Ä–∏–æ–¥

‚öôÔ∏è Data Mode API
–ú–µ—Ç–æ–¥	Endpoint	–û–ø–∏—Å–∞–Ω–∏–µ
POST	/mode/test	–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –≤ —Ç–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º
POST	/mode/live	–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –≤ live —Ä–µ–∂–∏–º

‚ù§Ô∏è System Health
–ú–µ—Ç–æ–¥	Endpoint	–û–ø–∏—Å–∞–Ω–∏–µ
GET	/health	–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã

üß† –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
Live/Test Modes: –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞ –ª–µ—Ç—É.

Fan-In / Fan-Out: –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø–æ—Ç–æ–∫–æ–≤ –¥–∞–Ω–Ω—ã—Ö.

Worker Pool: 5 –≤–æ—Ä–∫–µ—Ä–æ–≤ –Ω–∞ –∫–∞–∂–¥—É—é –±–∏—Ä–∂—É.

Redis + PostgreSQL: –∫—ç—à –∏ –Ω–∞–¥—ë–∂–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ.

Batch Insert: –≤—Å—Ç–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –ø–∞—á–∫–∞–º–∏.

Fallback: –µ—Å–ª–∏ Redis –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç ‚Äî —Å–æ—Ö—Ä–∞–Ω—è–µ–º –Ω–∞–ø—Ä—è–º—É—é –≤ –ë–î.

Failover: –∞–≤—Ç–æ-–ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ —Å–±–æ–µ.

üß™ –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω –æ—Ç–¥–µ–ª—å–Ω—ã–π generator.go, –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Å–ª—É—á–∞–π–Ω—ã–µ —Ü–µ–Ω—ã –¥–ª—è –≤—Å–µ—Ö –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã—Ö –ø–∞—Ä. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç Generator Pattern, —Å–æ–≤–º–µ—Å—Ç–∏–º —Å Fan-In –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π.

üíæ –•—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
PostgreSQL —Ç–∞–±–ª–∏—Ü–∞:

sql
Copy
Edit
CREATE TABLE price_stats (
  id SERIAL PRIMARY KEY,
  pair_name TEXT,
  exchange TEXT,
  timestamp TIMESTAMP,
  average_price FLOAT,
  min_price FLOAT,
  max_price FLOAT
);
Redis:

–ö–ª—é—á: exchange:symbol

–ó–Ω–∞—á–µ–Ω–∏—è: –ø–æ—Å–ª–µ–¥–Ω–∏–µ N —Ü–µ–Ω –∑–∞ –º–∏–Ω—É—Ç—É

ü™µ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è log/slog (Go 1.21+):

Info: —É—Å–ø–µ—à–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è (–ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è, –ø–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö).

Warn: –æ—à–∏–±–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–ª–∏ API.

Error: –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ —Å–±–æ–∏.

–í—Å–µ –ª–æ–≥–∏ —Å–æ–¥–µ—Ä–∂–∞—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç (symbol, exchange, duration –∏ —Ç.–ø.).

‚úÖ –ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–æ–≤–µ—Ä–∫–∏
‚úÖ –°–æ–±–∏—Ä–∞–µ—Ç—Å—è –∫–æ–º–∞–Ω–¥–æ–π: go build -o marketflow .

‚úÖ –ë–µ–∑ –≤–Ω–µ—à–Ω–∏—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫ (–∫—Ä–æ–º–µ PostgreSQL –∏ Redis).

‚úÖ –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç gofumpt.

‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Å–µ—Ö –æ—à–∏–±–æ–∫ –≤ JSON.

‚úÖ –ü–∞–Ω–∏–∫–∏ –∏—Å–∫–ª—é—á–µ–Ω—ã.

‚úÖ –í—Å–µ –∑–∞–ø—Ä–æ—Å—ã –∏–º–µ—é—Ç HTTP-–æ—Ç–≤–µ—Ç—ã —Å –∫–æ–¥–∞–º–∏ –∏ –æ–ø–∏—Å–∞–Ω–∏–µ–º –æ—à–∏–±–æ–∫.

